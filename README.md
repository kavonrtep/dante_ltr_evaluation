# Comparison of DANTE_LTR with Inpactor2 and EDTA

This repository include scripts used for evaluation of LTR-RT annotation method. The scripts were used for comparison of performance of DANTE_LTR, Inpactor2 and EDTA against the standard annotations.


## Requirements

Required packages are listed in `requirements.yaml` file. They can be installed using conda or mamba. To create conda environment with required packages, run the following command:
 
```bash
 conda env create -f requirements.yaml
```

## Data

Data used in evaluation are available in zenodo repository https://zenodo.org/doi/10.5281/zenodo.10891048. All data could be downloaded as zip archive. Directory `reference_genomes` contains all necessary input files (and also outputs) for evaluation of LTR-RT annotation methods. To download the data, run the following command:

```bash
wget https://zenodo.org/records/10891049/files/annotation_data.zip?download=1 -O annotation_data.zip
unzip annotation_data.zip
cd reference_genomes
```


## Included scripts

There are several scripts included in this repository:
- Scripts `maize_to_standard_annotation.R` and `rice_to_standard_annotation.R` are used to convert annotation obtained using different methods(DANTE_LTR, EDTA, Inpactor2, reference annotation) to standardized annotation which can be used for direct comparison. 
- Scripts `compare_annotation_maize.R` and `compare_annotation_rice.R` are used to compare annotation obtained from DANTE_LTR, Inpactor2 and EDTA with reference annotations for maize and rice genomes. 
   - These scripts are used to convert annotation suitable for comparison. Each base of the genome is assigned to one of the following four categories: LTR, LTR|Ty1/copia, LTR|Ty3/gypsy, no_annotation. This annotation is then compared with reference annotation for each method and stored in `rice_v7_plots` and `maize_B73_plots` directories as `annot_pairs_*_.csv`.
   - Comparison with reference annotation is then used to calculate FP, FN, TP, TN, sensitivity, specificity, precision, F1 score each method. The results are stored in `stat_LTR_RT.csv` in corresponding directories. These statistices are then used to create radar plots (files `annot_stat_comparison_full_elements_radarchart_ltr.pdf`).
   - Individual elements obtained from each method are compared with each other to get number of unique and shared elements. The results are exported as Venn diagrams in `annotation_overlaps.pdf` files.   
- Scripts `compare_annotation_maize_rm.R` and `compare_annotation_rice_rm.R` are used to compare similarity-based LTR-RT annotations using libraries of elements identified in rice and maize by DANTE_LTR, Inpactor2 and EDTA. The resulting annotations were scored against reference annotations of the rice and maize genomes. Output files are stored in `rice_v7_plots_rm` and `maize_B73_plots_rm` directories.
   - Each base of the similarity based annotations for maize and rice are compared with reference annotation and values of FP, FN, TP, TN, sensitivity, specificity, precision, F1 score are calculated. The results are stored in `stat_LTR_RT.csv` in corresponding directories. 
   - These statistices are then used to create radar plots (files `annot_stat_comparison_full_elements_radarchart_ltr_RM.pdf`) in corresponding directories.
   - Overlaps of true- and false-positive annotations generated by the compared pipelines is callculated and stored in files `annotation_overlaps_per_base_venn_all_RM_FP.csv`  and  `annotation_overlaps_per_base_venn_all_RM_TP.csv` in corresponding directories.
- Script `compare_annot_utils.R` contains utility functions used in the comparison scripts.


## Running the scripts

Scripts were executed using Pycharm IDE but they can be executed in any other suitable integrated development environment like VS code or RStudio. The scripts are written in R language.