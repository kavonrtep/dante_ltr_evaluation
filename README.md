# Comparison of DANTE_LTR with Inpactor2 and EDTA 

This repository includes scripts used for the evaluation of LTR-RT annotation methods. The scripts facilitate a comparison of the performance of DANTE_LTR, Inpactor2, and EDTA against standard annotations.

## Requirements 
Required packages are listed in the `requirements.yaml` file. They can be installed using Conda or Mamba. To create a Conda environment with the required packages, run the following command:

```bash
conda env create -f requirements.yaml
```

## Data 
The data used in this evaluation is available in the Zenodo repository: [https://zenodo.org/doi/10.5281/zenodo.10891048](https://zenodo.org/doi/10.5281/zenodo.10891048) . All data can be downloaded as a zip archive. The directory `reference_genomes` contains all necessary input files (and also outputs) for the evaluation of LTR-RT annotation methods. To download the data, run the following commands:

```bash
wget https://zenodo.org/records/10891049/files/annotation_data.zip?download=1 -O annotation_data.zip
unzip annotation_data.zip
cd reference_genomes
```

## Included Scripts 

The repository includes several scripts:
 
- `maize_to_standard_annotation.R` and `rice_to_standard_annotation.R` are used to convert annotations obtained using different methods (DANTE_LTR, EDTA, Inpactor2, and reference annotations) into a standardized format that can be used for direct comparison.
 
- `compare_annotation_maize.R` and `compare_annotation_rice.R` compare the annotations from DANTE_LTR, Inpactor2, and EDTA with reference annotations for maize and rice genomes, respectively. These scripts assign each base of the genome to one of the following four categories: LTR, LTR|Ty1/copia, LTR|Ty3/gypsy, or no_annotation. This annotation is then compared with reference annotations for each method and stored in `rice_v7_plots` and `maize_B73_plots` directories as `annot_pairs_*_.csv`. These comparisons are used to calculate FP, FN, TP, TN, sensitivity, specificity, precision, and F1 score for each method. The results are stored in `stat_LTR_RT.csv` in corresponding directories. These statistics are then used to create radar plots (files `annot_stat_comparison_full_elements_radarchart_ltr.pdf`). Individual elements obtained from each method are compared with each other to determine the number of unique and shared elements. The results are exported as Venn diagrams in `annotation_overlaps.pdf` files.
 
- `compare_annotation_maize_rm.R` and `compare_annotation_rice_rm.R` are used to compare similarity-based LTR-RT annotations using libraries of elements identified in rice and maize by DANTE_LTR, Inpactor2, and EDTA. The resulting annotations are scored against reference annotations of the rice and maize genomes. Output files are stored in `rice_v7_plots_rm` and `maize_B73_plots_rm` directories. Each base of the similarity-based annotations for maize and rice is compared with reference annotations, and values of FP, FN, TP, TN, sensitivity, specificity, precision, and F1 score are calculated. The results are stored in `stat_LTR_RT.csv` in corresponding directories. These statistics are then used to create radar plots (files `annot_stat_comparison_full_elements_radarchart_ltr_RM.pdf`) in corresponding directories. Overlaps of true- and false-positive annotations generated by the compared pipelines are calculated and stored in files `annotation_overlaps_per_base_venn_all_RM_FP.csv` and `annotation_overlaps_per_base_venn_all_RM_TP.csv` in corresponding directories.
 
- The script `compare_annot_utils.R` contains utility functions used in the comparison scripts.

## Running the Scripts 

Although the scripts were executed using the PyCharm IDE, they can be executed in any other suitable integrated development environment like VS Code or RStudio. The scripts are written in the R language.